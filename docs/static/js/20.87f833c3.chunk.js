(window.webpackJsonp=window.webpackJsonp||[]).push([[20],{1402:function(e,t,n){e.exports={x6dnd:"X6DndGraph_x6dnd__34Xov",component:"X6DndGraph_component__7q1PX",wrapper:"X6DndGraph_wrapper__2AVqN",stencil:"X6DndGraph_stencil__21abQ",container:"X6DndGraph_container__3ZzDT",toolbar:"X6DndGraph_toolbar__2HmC4",graph:"X6DndGraph_graph__3O_Ro","x6-graph-scroller":"X6DndGraph_x6-graph-scroller__1I59x"}},1403:function(e,t,n){e.exports={container:"X6ReactTrigger_container__3lW6w",title:"X6ReactTrigger_title__21kuW",content:"X6ReactTrigger_content__1yQMJ"}},1535:function(e,t,n){"use strict";n.r(t);var o=n(2),a=n(4),i=n(6),r=n(3),l=n(7),c=n(5),d=n(276),s=n(40),h=n(1517),g=(n(415),n(1400),n(1401),n(1402)),p=n.n(g),u=n(1403),m=n.n(u),f=function(e){function t(e){var n;return Object(o.a)(this,t),(n=Object(i.a)(this,Object(r.a)(t).call(this,e))).onChange=function(e){n.setState({name:e.target.value})},n.onDelete=function(){var e=n.state.editable;n.setState({editable:!e},function(){var e=n.props.node,t=n.state.name;e.setData({name:t})})},console.log("constructor"),n.state={name:"",editable:!1},n}return Object(l.a)(t,e),Object(a.a)(t,[{key:"shouldComponentUpdate",value:function(e,t){if(console.log("SCU====>",e,t),t.name!==this.state.name)return!0;var n=this.props.node;return!(!n||!n.hasChanged("data"))||(console.log("no-rerender======>",this.props.node===e.node),!1)}},{key:"componentDidUpdate",value:function(){console.log("didUpdate======>",this.props)}},{key:"render",value:function(){console.log("render=======>",this.props);var e=this.props.content,t=this.state,n=t.name,o=t.editable;return c.createElement("div",{className:m.a.container},c.createElement("div",{className:m.a.title},o?c.createElement("input",{value:n,placeholder:"\u8bf7\u8f93\u5165\u65b0\u540d\u5b57",onChange:this.onChange}):c.createElement("span",{className:m.a.name},n),c.createElement("button",{className:m.a.delete,onClick:this.onDelete},o?"\u4fdd\u5b58":"\u7f16\u8f91")),c.createElement("div",{className:m.a.content},e))}}]),t}(c.Component);f.defaultProps={width:40,height:40,name:"\u5ba2\u7fa4",type:"consumer",content:"default content"};var w=f,v=s.k.Rect,b=s.k.Circle,x=h.a.Item,_=h.a.Group,y={nodes:[{id:"node1",x:40,y:40,width:80,height:40,label:"node1"},{id:"node2",x:160,y:180,width:80,height:40,label:"node2"},{id:"node3",x:160,y:180,width:80,height:40,label:"node3"},{id:"node4",x:160,y:180,width:80,height:40,label:"node4"},{id:"node5",x:40,y:40,width:80,height:40,label:"node5"},{id:"node6",x:160,y:180,width:80,height:40,label:"node6"},{id:"node7",x:160,y:180,width:80,height:40,label:"node7"},{id:"node8",x:160,y:180,width:80,height:40,label:"node8"},{id:"node8",x:160,y:180,width:80,height:40,label:"node8"},{id:"node9",x:160,y:180,width:80,height:40,label:"node9"},{id:"node10",x:160,y:180,width:80,height:40,label:"node10"},{id:"node11",x:160,y:180,width:80,height:40,label:"node11"},{id:"node12",x:160,y:180,width:80,height:40,label:"node12"}],edges:[{source:"node1",target:"node10"},{source:"node1",target:"node8"},{source:"node1",target:"node3"},{source:"node1",target:"node9"},{source:"node1",target:"node2"},{source:"node2",target:"node4"},{source:"node2",target:"node5"},{source:"node2",target:"node6"},{source:"node2",target:"node7"},{source:"node9",target:"node11"},{source:"node9",target:"node12"}]},k=function(e){function t(e){var n;return Object(o.a)(this,t),(n=Object(i.a)(this,Object(r.a)(t).call(this,e))).container=null,n.stencilContainer=null,n.graph=void 0,n.stencil=void 0,n.getnerateTreeFromEdges=function(e){e.forEach(function(e){var t={id:e.source,prev:null,next:null},n={id:e.target,prev:t,next:null};t.next=n})},n.refContainer=function(e){n.container=e},n.refStencil=function(e){n.stencilContainer=e},n.onGetAll=function(){if(n.graph){var e=n.graph.getCells();console.log("cells======>",e)}},n.onAutoLayout=function(){if(n.graph){var e=n.graph.getRootNodes();if(1===e.length){var t,o=e[0],a=new Map([]),i=n.graph.getLeafNodes();console.log("leafCount===>",i.length);var r=null===(t=n.graph)||void 0===t?void 0:t.getNeighbors(o,{outgoing:!0});n.graph.searchCell(o,function(e,t){if(0===t)e.isNode()&&e.position(0,0);else if(e.isNode()){var o,i,l=90*r.length/2;console.log("offset====>",l);var c=null===(o=n.graph)||void 0===o?void 0:o.getPredecessors(e,{breadthFirst:!0,distance:1}),d=null,s={};Array.isArray(c)&&(d=c[c.length-1]),null!==(i=d)&&void 0!==i&&i.isNode()&&(s=d.position()),console.log("cell====>",e,d,r,s);var h=a.get(t);void 0===h?h=1:h+=1,a.set(t,h);var g=s.x+80+200,p=s.y+130*(h-1)-l;e.position(g,p)}},{breadthFirst:!0,outgoing:!0})}}},n.state={node:null},n}return Object(l.a)(t,e),Object(a.a)(t,[{key:"componentDidMount",value:function(){this.graph=new s.d({container:this.container,grid:!0,snapline:{enabled:!0,sharp:!0},scroller:{enabled:!0,pageVisible:!1,pageBreak:!1,pannable:!0}}),this.graph.fromJSON(y),this.stencil=new s.a.Stencil({title:"\u4e1a\u52a1\u7ec4\u4ef6\u5e93",target:this.graph,search:function(e,t){return-1!==e.shape.indexOf(t)},placeholder:"\u8bf7\u8f93\u5165\u7ec4\u4ef6\u540d\u79f0",notFoundText:"\u672a\u641c\u7d22\u5230\u6307\u5b9a\u7684\u7ec4\u4ef6",collapsable:!0,stencilGraphWidth:200,stencilGraphHeight:180,groups:[{name:"trigger",title:"\u89e6\u53d1",graphHeight:100,graphOptions:{scroller:!0}},{name:"flow",title:"\u6d41\u7a0b\u63a7\u5236",collapsed:!0},{name:"strategy",title:"\u7b56\u7565",collapsed:!0},{name:"actions",title:"\u52a8\u4f5c",collapsed:!0},{name:"productions",title:"\u6570\u636e\u4ea7\u54c1",collapsed:!0}],getDragNode:function(e,t){return console.log("getDragNode====>",e,t),e.clone()},getDropNode:function(e,t){console.log("getDropNode=====>",e,t);var n=e.clone().size({width:240,height:80});return n.addPorts([{id:"port1",attrs:{circle:{magnet:!0}}},{id:"port2",attrs:{circle:{magnet:!0}}}]),n}}),this.stencilContainer&&this.stencilContainer.appendChild(this.stencil.container);var e=new v({width:70,height:40,attrs:{rect:{fill:"#31D0C6",stroke:"#4B4A67",strokeWidth:6},text:{text:"rect",fill:"white"}}}),t=new b({width:60,height:60,data:{data:"myData"},attrs:{circle:{fill:"#FE854F",strokeWidth:6,stroke:"#4B4A67"},text:{text:"ellipse",fill:"white"}}}),n=new b({width:60,height:60,attrs:{circle:{fill:"#4B4A67","stroke-width":6,stroke:"#FE854F"},text:{text:"ellipse",fill:"white"}}}),o=new v({width:70,height:40,attrs:{rect:{fill:"#4B4A67",stroke:"#31D0C6",strokeWidth:6},text:{text:"rect",fill:"white"}}}),a=new v({width:70,height:40,attrs:{rect:{fill:"#31D0C6",stroke:"#4B4A67",strokeWidth:6},text:{text:"rect",fill:"white"}}}),i=new b({width:60,height:60,attrs:{circle:{fill:"#FE854F",strokeWidth:6,stroke:"#4B4A67"},text:{text:"ellipse",fill:"white"}},ports:[{id:"port1",attrs:{circle:{magnet:!0}}},{id:"port2",attrs:{circle:{magnet:!0}}}]}),r={shape:"react-shape",width:60,height:60,component:c.createElement(w,null)};this.stencil.load([e,t,r],"trigger"),this.stencil.load([n.clone(),o,a,i],"flow")}},{key:"componentDidUpdate",value:function(){console.log("didUpdate========>",this.state)}},{key:"render",value:function(){return c.createElement("div",{className:p.a.x6dnd},c.createElement("div",{className:p.a.component},c.createElement(w,null)),c.createElement("div",{className:p.a.wrapper,style:{width:"100%"}},c.createElement("div",{className:p.a.stencil,ref:this.refStencil}),c.createElement("div",{className:p.a.container},c.createElement(h.a,{className:p.a.toolbar},c.createElement(_,null,c.createElement(x,{name:"zoomIn",tooltip:"\u7f29\u5c0f",icon:""},"\u7f29\u5c0f"),c.createElement(x,{name:"zoomOut",tooltip:"\u653e\u5927",icon:""},"\u653e\u5927"),c.createElement(x,{name:"auto",tooltip:"\u81ea\u52a8\u5e03\u5c40",onClick:this.onAutoLayout,icon:""},"\u81ea\u52a8\u5e03\u5c40")),c.createElement(_,null,c.createElement(x,{name:"all",tooltip:"\u83b7\u53d6\u8282\u70b9",onClick:this.onGetAll},"\u83b7\u53d6\u8282\u70b9"))),c.createElement("div",{className:p.a.graph,ref:this.refContainer}))))}}]),t}(c.Component),E=function(e){function t(){return Object(o.a)(this,t),Object(i.a)(this,Object(r.a)(t).apply(this,arguments))}return Object(l.a)(t,e),Object(a.a)(t,[{key:"render",value:function(){return c.createElement("div",{style:{width:"100%",height:"100%",overflow:"auto"}},c.createElement(k,null))}}]),t}(c.Component);t.default=Object(d.b)(function(e){return e.x6})(E)}}]);
//# sourceMappingURL=20.87f833c3.chunk.js.map