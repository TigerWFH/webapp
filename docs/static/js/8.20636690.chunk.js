(window.webpackJsonp=window.webpackJsonp||[]).push([[8],{786:function(e,t,n){e.exports={sidebar:"Stencil_sidebar__6-3NF",title:"Stencil_title__1rEvH",gtitle:"Stencil_gtitle__3We5B",search:"Stencil_search__1JJxM",container:"Stencil_container__1PAXR",tools:"Stencil_tools__3Sb1B",tool:"Stencil_tool__2aukW",noresult:"Stencil_noresult__jxg_x"}},787:function(e,t,n){e.exports={droptarget:"DropTarget_droptarget__3BpH_"}},788:function(e,t,n){e.exports={dragsource:"DragSource_dragsource__3Up37",default:"DragSource_default__37TDy",icon:"DragSource_icon__azWm1",name:"DragSource_name__3iYLy"}},789:function(e,t,n){e.exports={background:"Background_background__3KzEz"}},790:function(e,t,n){e.exports={alert:"Alert_alert__1YTmw"}},793:function(e,t,n){e.exports={cmsworkbench:"CmsWorkbench_cmsworkbench__1oE2_",toolbar:"CmsWorkbench_toolbar__2loCb",active:"CmsWorkbench_active__J61_m",toollist:"CmsWorkbench_toollist__3X4S3",business:"CmsWorkbench_business__8Gubz",save:"CmsWorkbench_save__okfdQ",content:"CmsWorkbench_content__3fzNt",workbench:"CmsWorkbench_workbench__3-YoO",pc:"CmsWorkbench_pc__2rUXF",phone:"CmsWorkbench_phone__mqcmh",unit:"CmsWorkbench_unit__1kQU3",delete:"CmsWorkbench_delete__2IF-e",component:"CmsWorkbench_component__1_zDn",config:"CmsWorkbench_config__3KTNu",preview:"CmsWorkbench_preview__3Ofc_"}},794:function(e,t,n){e.exports={container:"X6Workbench_container__2W2GH",toolbar:"X6Workbench_toolbar__38IAD",graph:"X6Workbench_graph___Ojbu",selected:"X6Workbench_selected__efbet",myport:"X6Workbench_myport__AQypD"}},795:function(e,t,n){e.exports={root:"WfhRect_root__3qnWL"}},796:function(e,t,n){e.exports={root:"WfhTriangle_root__q5VVR"}},797:function(e,t,n){e.exports={container:"x6_container__1aBM4",mine:"x6_mine__3RLXB",dndframe:"x6_dndframe__380uv",sidebar:"x6_sidebar__3KL-I",content:"x6_content__YNsLB"}},823:function(e,t,n){"use strict";n.r(t);var o=n(0),a=n(1),l=n(2),r=n(3),c=n(4),i=n.n(c),u=n(814),s=n(701),d=n(685),m=n(786),p=n.n(m),g=function(e){Object(l.a)(n,e);var t=Object(r.a)(n);function n(e){var a;return Object(o.a)(this,n),(a=t.call(this,e)).onSearch=function(e){var t=e.target.value,n=a.state.allToolList,o=n;console.log("search===>",o),t&&(o=n.filter(function(e){var n,o;return(null===(n=e.name)||void 0===n?void 0:n.indexOf(t))>-1||(null===(o=e.id)||void 0===o?void 0:o.indexOf(t))>-1})),a.setState({toolList:o})},a.state={toolList:a.props.toolList.toJS(),allToolList:a.props.toolList.toJS(),prevToolList:a.props.toolList},a}return Object(a.a)(n,[{key:"render",value:function(){var e=this.props,t=e.dragSource,n=e.bSearch,o=e.title,a=void 0===o?"\u5de5\u5177\u96c6":o,l=e.notFoundText,r=void 0===l?"\u6ca1\u6709\u627e\u5230\u5bf9\u5e94\u7684\u6a21\u677f":l,i=this.state.toolList;return c.createElement("div",{className:p.a.sidebar},a?c.createElement("div",{className:p.a.title},a):null,n?c.createElement("div",{className:p.a.search},c.createElement("input",{placeholder:"\u8bf7\u8f93\u5165\u641c\u7d22\u5185\u5bb9",onChange:this.onSearch})):null,i.length>0?c.createElement("div",{className:p.a.container},c.createElement("div",{className:p.a.gtitle},"stencils"),c.createElement("div",{className:p.a.tools},i.map(function(e,n){return c.createElement("div",{className:p.a.tool,key:"".concat(e.id,"-").concat(n)},c.createElement(t,Object.assign({key:"".concat(e.id,"-").concat(n)},e)))}))):c.createElement("div",{className:p.a.noresult},r))}}],[{key:"getDerivedStateFromProps",value:function(e,t){var n=e.toolList,o=t.prevToolList;return d.a.is(o,n)?null:{toolList:n.toJS(),allToolList:n.toJS(),prevToolList:n}}}]),n}(c.Component);g.defaultProps={toolList:[],bSearch:!0};var v=g,h=n(14),f=n(11),b=n(8),y=n(828),E=n(787),_=n.n(E),k=n(832),T=function(e){return e.X6_DROP_TARGET="X6_DROP_TARGET",e}(T||{}),O=function(e){return e.DRAG_NODE_DATA="DRAG_NODE_DATA",e.COPY_EDGE_DATA="COPY_NODE_DATA",e.API_DATA="API_DATA",e.OTHER_DATA="OTHER_DATA",e}(O||{}),C={dataList:d.a.List([]),edgeList:d.a.List([]),current:d.a.Map({}),configs:d.a.Map({}),dataSource:O.DRAG_NODE_DATA};function w(e,t){var n=t.type,o=t.payload;switch(n){case"init":var a=o.dataList,l=void 0===a?[]:a,r=o.edgeList,c=void 0===r?[]:r,i=o.current,u=void 0===i?{}:i,s=o.configs,m=void 0===s?{}:s;return{dataList:d.a.List.isList(l)?l:d.a.List(l),edgeList:d.a.List.isList(c)?c:d.a.List(c),current:d.a.Map.isMap(u)?u:d.a.Map(u),configs:d.a.Map.isMap(m)?m:d.a.Map(m),dataSource:O.API_DATA};case"drop":var p=e.dataList,g=e.edgeList,v=e.configs;return{dataList:p.push(o),edgeList:g,current:d.a.Map(o),configs:v,dataSource:O.DRAG_NODE_DATA};case"deleteData":var h=e.current,y=e.configs,E=e.dataList,_=h.id,k=E.filter(function(e){return e.id!==_});delete y[_];var T=k[0];return Object(b.a)(Object(b.a)({},e),{},{dataList:k,current:T,configs:Object(b.a)({},y)});case"edge":case"deleteEdge":return e;case"current":return Object(b.a)(Object(b.a)({},e),{},{current:d.a.Map(o)});case"configs":var C=e.configs,w=o.id,j=o.config,x=C[w]||{};return Object(b.a)(Object(b.a)({},e),{},{configs:Object(b.a)(Object(b.a)({},C),{},Object(f.a)({},w,Object(b.a)(Object(b.a)({},x),j)))});default:return e}}var j=function(e){var t=c.useReducer(w,C),n=Object(h.a)(t,2),o=n[0],a=o.dataList,l=o.edgeList,r=o.current,i=o.configs,u=o.dataSource,s=n[1],d=c.useCallback(function(e){s({type:"init",payload:e})},[]),m=c.useCallback(function(){s({type:"deleteData"})},[]),p=c.useCallback(function(e){s({type:"edge",payload:e})},[]),g=c.useCallback(function(e){s({type:"deleteEdge",payload:e})},[]),v=c.useCallback(function(e){s({type:"current",payload:e})},[]),f=c.useCallback(function(e){s({type:"configs",payload:e})},[]);console.log("dropTarget=====configs====>",i);var E=e.workbench,O=e.accept,j=void 0===O?[T.X6_DROP_TARGET]:O,x=Object(y.a)(function(){return{accept:j,drop:function(e,t){var n=Object(k.a)({node:[1,35,69,103,137,171],clockseq:4660,msecs:(new Date).getTime(),nsecs:5678});return s({type:"drop",payload:Object(b.a)({id:n},e)}),{}},collect:function(e){return{demo:"xxxx"}}}}),N=Object(h.a)(x,2),D=N[0],L=N[1];return c.createElement("div",{ref:L,className:_.a.droptarget},c.createElement(E,Object.assign({init:d,dataList:a,dataSource:u,deleteData:m,edgeList:l,setEdge:p,deleteEdge:g,current:r,setCurrent:v,configs:i,setConfigs:f},D)))},x=n(827),N=n(788),D=n.n(N),L=function(e){return e.X6_DROP_TARGET="X6_DROP_TARGET",e}(L||{});function S(e){return c.createElement("div",{className:D.a.default},c.createElement("div",{className:D.a.icon}),c.createElement("div",{className:D.a.name},e.name))}var A=function(e){var t=e.type,n=void 0===t?L.X6_DROP_TARGET:t,o=e.name,a=e.toolComponent,l=e.data,r=void 0===l?{}:l,i=Object(x.a)(function(){return console.log("useDrag-----data=======>",r),{type:n,item:Object(b.a)({},r),end:function(){},collect:function(e){return{demo:"demo"}}}}),u=Object(h.a)(i,2)[1],s=c.createElement(S,{name:o});return a&&(s=a),c.createElement("div",{className:D.a.dragsource,ref:u},s)},I=n(789),M=n.n(I);function H(e){if(e.componentType!==H.componentType)return null;var t={backgroundColor:e.color,backgroundImage:e.image};return c.createElement("div",{className:M.a.background,style:t})}function R(e){var t=e.color,n=e.setConfig,o=c.useState(t||""),a=Object(h.a)(o,2),l=a[0],r=a[1];return c.createElement("div",null,c.createElement("span",null,"Background"),c.createElement("input",{value:l,onChange:c.useCallback(function(e){n("color",e.target.value),r(e.target.value)},[]),placeholder:"\u8bf7\u8f93\u5165\u516d\u4f4d\u989c\u8272\u503c"}))}H.thumbnail="\u80cc\u666f\u8272",H.componentType="background",H.title="\u80cc\u666f\u8272",R.componentType="background";var W=n(790),P=n.n(W);function q(e){var t=e.text;return c.createElement("div",{className:P.a.alert},t)}function G(e){var t=e.text,n=e.setConfig;if(e.componentType!==q.componentType)return null;return c.createElement("div",null,c.createElement("span",null,"Alert"),c.createElement("input",{value:t,onChange:function(e){n("text",e.target.value)},placeholder:"\u8bf7\u8f93\u5165\u8b66\u544a\u6587\u6863"}))}q.thumbnail="\u8b66\u544a\u4fe1\u606f",q.componentType="alert",q.title="\u8b66\u544a\u4fe1\u606f",G.componentType="alert";var X=n(819),J=n(825),U=n(817),V=n(824),B=n(821);function F(e){console.log("WfhInput====>",e);var t=e.label,n=e.param,o=e.required,a=void 0===o?{}:o,l=e.length,r=void 0===l?Number.MAX_SAFE_INTEGER:l,i=e.holder,u=void 0===i?void 0:i;return c.createElement(X.a.Item,{label:t,name:n||"name",rules:[{required:"\u662f"===a.value,message:"".concat(t,"\u662f\u5fc5\u586b\u5b57\u6bb5")}]},c.createElement(J.a,{maxLength:r,placeholder:u}))}F.thumbnail="\u5355\u884c\u6587\u672c",F.componentType="wfhinput",F.title="\u5355\u884c\u6587\u672c";var Y=[{label:"\u662f",value:"\u662f"},{label:"\u5426",value:"\u5426"}],z={title:"WfhInput\u7ec4\u4ef6\u5c5e\u6027",base:"\u57fa\u7840\u5c5e\u6027",label:"\u6807\u9898",labelHolder:"\u8bf7\u8f93\u5165\u6807\u9898",param:"\u5bf9\u5e94\u5165\u53c2",paramHolder:"\u8bf7\u9009\u62e9\u5bf9\u5e94\u5165\u53c2",holder:"\u5360\u4f4d\u63d0\u793a",holderHolder:"\u8bf7\u8f93\u5165\u5360\u4f4d\u63d0\u793a",spec:"\u6821\u9a8c\u5c5e\u6027",required:"\u5fc5\u586b",requiredHolder:"\u8bf7\u9009\u62e9\u662f\u5426\u5fc5\u586b",maxlength:"\u6700\u5927\u957f\u5ea6",maxlengthHolder:"\u8bf7\u8f93\u5165\u6700\u5927\u957f\u5ea6"};function K(e,t){var n=X.a.useForm(),o=Object(h.a)(n,1)[0];c.useImperativeHandle(t,function(){return{form:o}});var a=c.useState([]),l=Object(h.a)(a,2),r=l[0],i=l[1];c.useEffect(function(){setTimeout(function(){i([{label:"uid",value:"uid",other:"1"},{label:"name",value:"name",other:"2"},{label:"age",value:"age",other:"3"}])},1e3)},[]);var u=e.config,s=e.setConfig;if(e.componentType!==F.componentType)return null;var d=Object.keys(u).reduce(function(e,t){var n={name:[t],value:u[t]};return e.push(n),e},[]);return c.createElement(X.a,{fields:d,form:o,onValuesChange:function(e,t){var n=Object.keys(e)[0];s(n,e[n])},labelCol:{span:6}},c.createElement(U.a,{title:z.title},c.createElement("h3",null,z.base),c.createElement(X.a.Item,{label:z.label,name:"label",rules:[{required:!0,message:z.labelHolder}]},c.createElement(J.a,{maxLength:10,placeholder:z.labelHolder})),c.createElement(X.a.Item,{label:z.param,name:"param",rules:[{required:!0,message:z.paramHolder}]},c.createElement(V.a,{labelInValue:!0,placeholder:z.paramHolder},r.map(function(e){return c.createElement(V.a.Option,{key:e.value,value:e.value},e.label)}))),c.createElement(X.a.Item,{label:z.holder,name:"holder"},c.createElement(J.a,{maxLength:20,placeholder:z.holderHolder})),c.createElement("h3",null,z.spec),c.createElement(X.a.Item,{label:z.required,name:"required"},c.createElement(V.a,{labelInValue:!0,placeholder:z.requiredHolder},Y.map(function(e){return c.createElement(V.a.Option,{key:e.value,value:e.value},e.label)}))),c.createElement(X.a.Item,{label:z.maxlength,name:"length"},c.createElement(B.a,{min:0,placeholder:z.maxlengthHolder}))))}var Q=c.forwardRef(K);function Z(e){var t=e.text;return c.createElement("div",null,t)}function $(e){var t=e.text,n=e.setConfig;if(e.componentType!==Z.componentType)return null;return c.createElement("div",null,c.createElement("span",null,"WfhInputNum"),c.createElement("input",{value:t,onChange:function(e){n("text",e.target.value)},placeholder:"\u8bf7\u8f93\u5165\u8b66\u544a\u6587\u6863"}))}function ee(e){var t=e.text;return c.createElement("div",null,t)}Z.thumbnail="\u6570\u503c\u8f93\u5165",Z.componentType="wfhinputnum",Z.title="\u6570\u503c\u8f93\u5165",$.componentType="input",ee.thumbnail="\u4e0b\u62c9\u6846",ee.componentType="wfhselect",ee.title="\u4e0b\u62c9\u6846";var te=[{label:"\u662f",value:"\u662f"},{label:"\u5426",value:"\u5426"}],ne={title:"WfhSelect\u7ec4\u4ef6\u5c5e\u6027",base:"\u57fa\u7840\u5c5e\u6027",label:"\u6807\u9898",labelHolder:"\u8bf7\u8f93\u5165\u6807\u9898",param:"\u5bf9\u5e94\u5165\u53c2",paramHolder:"\u8bf7\u9009\u62e9\u5bf9\u5e94\u5165\u53c2",holder:"\u5360\u4f4d\u63d0\u793a",holderHolder:"\u8bf7\u8f93\u5165\u5360\u4f4d\u63d0\u793a",search:"\u641c\u7d22",searchHolder:"\u8bf7\u914d\u7f6e\u662f\u5426\u652f\u6301\u641c\u7d22",spec:"\u6821\u9a8c\u5c5e\u6027",required:"\u662f\u5426\u5fc5\u586b",requiredHolder:"\u8bf7\u9009\u62e9\u662f\u5426\u5fc5\u586b",option:"\u9009\u9879\u5c5e\u6027",source:"\u6570\u636e\u6e90",sourceHolder:"\u8bf7\u8f93\u5165\u6570\u636e\u6e90",select:"\u9009\u9879\u5b57\u6bb5",selectHolder:"\u8bf7\u914d\u7f6e\u9009\u9879\u5b57\u6bb5",inparam:"\u5165\u53c2\u5b57\u6bb5",inparamHolder:"\u8bf7\u914d\u7f6e\u5165\u53c2\u5b57\u6bb5",type:"\u9009\u9879\u7c7b\u578b",typeHolder:"\u8bf7\u914d\u7f6e\u9009\u9879\u7c7b\u578b",remote:"\u8fdc\u7a0b\u6570\u636e\u6e90",remoteHolder:"\u8bf7\u914d\u7f6e\u8fdc\u7a0b\u6570\u636e\u6e90",multiple:"\u662f\u5426\u591a\u9009",multipleHolder:"\u8bf7\u914d\u7f6e\u662f\u5426\u652f\u6301\u591a\u9009"};function oe(e,t){var n=X.a.useForm(),o=Object(h.a)(n,1)[0],a=e.setConfig,l=e.componentType;c.useImperativeHandle(t,function(){return{form:o}});var r=c.useCallback(function(e,t){var n=Object.keys(e)[0];a(n,e[n])},[a]),i=c.useState([]),u=Object(h.a)(i,2),s=u[0],d=u[1];return c.useEffect(function(){setTimeout(function(){d([{label:"uid",value:"uid",other:"1"},{label:"name",value:"name",other:"2"},{label:"age",value:"age",other:"3"}])},1e3)},[]),l!==ee.componentType?null:c.createElement(X.a,{onValuesChange:r,labelCol:{span:6}},c.createElement(U.a,{title:ne.title},c.createElement("h3",null,ne.base),c.createElement(X.a.Item,{label:ne.label,name:"label",rules:[{required:!0,message:ne.multipleHolder}]},c.createElement(J.a,{maxLength:10,placeholder:ne.labelHolder})),c.createElement(X.a.Item,{label:ne.param,name:"param",rules:[{required:!0,message:ne.multipleHolder}]},c.createElement(V.a,{labelInValue:!0,placeholder:ne.paramHolder},s.map(function(e){return c.createElement(V.a.Option,{key:e.value,value:e.value},e.label)}))),c.createElement(X.a.Item,{label:ne.holder,name:"holder"},c.createElement(J.a,{maxLength:20,placeholder:ne.holderHolder})),c.createElement(X.a.Item,{label:ne.search},c.createElement(V.a,{labelInValue:!0,placeholder:ne.searchHolder})),c.createElement("h3",null,ne.spec),c.createElement(X.a.Item,{label:ne.source,name:"source",rules:[{required:!0,message:ne.sourceHolder}]},c.createElement(J.a,{placeholder:ne.sourceHolder})),c.createElement(X.a.Item,{label:ne.select,name:"select",rules:[{required:!0,message:ne.selectHolder}]},c.createElement(J.a,{placeholder:ne.selectHolder})),c.createElement(X.a.Item,{label:ne.inparam,name:"inparam",rules:[{required:!0,message:ne.inparamHolder}]},c.createElement(J.a,{placeholder:ne.inparamHolder})),c.createElement(X.a.Item,{label:ne.multiple,name:"multipe"},c.createElement(V.a,{labelInValue:!0,placeholder:ne.multipleHolder},te.map(function(e){return c.createElement(V.a.Option,{key:e.value,value:e.value},e.label)}))),c.createElement("h3",null,ne.spec),c.createElement(X.a.Item,{label:ne.required,name:"required",rules:[{required:!0,message:ne.requiredHolder}]},c.createElement(V.a,{labelInValue:!0,placeholder:ne.requiredHolder},te.map(function(e){return c.createElement(V.a.Option,{key:e.value,value:e.value},e.label)})))))}var ae=c.forwardRef(oe);function le(e){var t=e.text;return c.createElement("div",null,t)}function re(e){var t=e.text,n=e.setConfig;if(e.componentType!==le.componentType)return null;return c.createElement("div",null,c.createElement("span",null,"WfhTable"),c.createElement("input",{value:t,onChange:function(e){n("text",e.target.value)},placeholder:"\u8bf7\u8f93\u5165\u8b66\u544a\u6587\u6863"}))}le.thumbnail="\u8868\u683c",le.componentType="wfhtable",le.title="\u8868\u683c",re.componentType="input";var ce=n(793),ie=n.n(ce),ue=["background"],se=new Map([[H.componentType,H],[q.componentType,q],[F.componentType,F],[Z.componentType,Z],[ee.componentType,ee],[le.componentType,le]]),de=new Map([[H.componentType,R],[q.componentType,G],[F.componentType,Q],[Z.componentType,$],[ee.componentType,ae],[le.componentType,re]]);var me=function(e){var t=e.dataList,n=e.deleteData,o=e.current,a=e.setCurrent,l=e.configs,r=e.setConfigs,i=o.toJS(),u=i.id,s=i.componentType,d=i.displayName;console.log("cmsworkbench====>",e);var m=c.useReducer(function(e,t){var n=t.type,o=void 0===n?"":n,a=t.payload,l=void 0!==a&&a;switch(o){case"preview":return Object(b.a)(Object(b.a)({},e),{},{bPreview:l});case"phone":return Object(b.a)(Object(b.a)({},e),{},{bPhone:l});default:return e}},{bPreview:!1,bPhone:!1}),p=Object(h.a)(m,2),g=p[0],v=g.bPreview,y=g.bPhone,E=p[1],_=de.get(s),k=c.useRef(null),T=l.toJS()[u]||{},O={};function C(){n()}return T.color&&(O.backgroundColor=T.color),T.image&&(O.backgroundImage=T.image),c.createElement("div",{className:ie.a.cmsworkbench},c.createElement("div",{className:ie.a.toolbar},c.createElement("div",{className:ie.a.toollist},c.createElement("div",{onClick:function(){E({type:"phone",payload:!y})},className:y?ie.a.active:""},"\u624b\u673a"),c.createElement("div",{onClick:function(){E({type:"preview",payload:!0})}},"\u9884\u89c8")),c.createElement("div",{className:ie.a.business},c.createElement("div",{className:ie.a.save,onClick:function(){var e;k&&(null===(e=k.current)||void 0===e||e.form.validateFields(),console.log("workbench-config====>",T))}},"\u4fdd\u5b58"))),c.createElement("div",{className:ie.a.content},c.createElement("div",{className:ie.a.workbench,style:O},c.createElement("div",{className:y?ie.a.phone:ie.a.pc},t.toJS().map(function(e,t){var n=e.componentType,o=void 0===n?"":n,r=e.id;if(ue.includes(o))return null;var i=se.get(o),s=l[r];return i?c.createElement("div",{className:ie.a.unit,key:"".concat(e.componentType,"-").concat(t),onClick:function(){return a(e)}},u===r?c.createElement("div",{className:ie.a.delete,onClick:C},"\u5220\u9664"):null,c.createElement("div",{className:ie.a.component},c.createElement(i,s))):null}))),c.createElement("div",{className:ie.a.config},_?c.createElement(_,Object.assign({key:u,ref:k,componentType:s,displayName:d,config:T},T,{setConfig:function(e,t){r({id:u,config:Object(f.a)({},e,t)})}})):null)),v?c.createElement("div",{className:ie.a.preview},"preview"):null)},pe=n(85),ge=n.n(pe),ve=n(61),he=n(804),fe=n(802),be=n(724),ye=n(726),Ee=n(794),_e=n.n(Ee),ke=n(254),Te=n(795),Oe=n.n(Te),Ce=function(e){Object(l.a)(n,e);var t=Object(r.a)(n);function n(e){var a;return Object(o.a)(this,n),(a=t.call(this,e)).count=void 0,a.onChangeData=function(){var e=a.props.node;console.log("node=======>",e),null===e||void 0===e||e.setData({name:"changeData-".concat(a.count++)})},a.onChangeName=function(){a.setState({name:666})},console.log("constructor"),a.state={name:"default"},a.count=0,a}return Object(a.a)(n,[{key:"shouldComponentUpdate",value:function(e,t){var n=this.props.node,o=this.props.node;console.log("SCU=====>",n===o);var a=null===o||void 0===o?void 0:o.getData();return null!==o&&void 0!==o&&o.hasChanged("data")?(console.log("hasChange====>",a),!0):(console.log("data didnot change====>",a),!1)}},{key:"componentDidMount",value:function(){var e=Date.now(),t=Date.now()-e;console.log("begin===>",e,t)}},{key:"compoenntDidUpdate",value:function(){console.log("didUpdate",this.props)}},{key:"renderClassic",value:function(e){return i.a.createElement("div",{className:Oe.a.root},"id:".concat(e))}},{key:"renderSimplified",value:function(e){return i.a.createElement("div",null,"id: ".concat(e))}},{key:"render",value:function(){var e=this.props.node,t=((null===e||void 0===e?void 0:e.getData())||{}).type;return console.log("mode========>",t),"simplified"===t?this.renderSimplified(e.id):this.renderClassic(e.id)}}]),n}(c.Component);Ce.componentType=void 0,Ce.title=void 0,Ce.componentType="wfh-rect",Ce.title="rect";var we=n(10),je=n(7),xe=n(818),Ne=n(830),De=function(e){Object(l.a)(n,e);var t=Object(r.a)(n);function n(){var e;Object(o.a)(this,n);for(var a=arguments.length,l=new Array(a),r=0;r<a;r++)l[r]=arguments[r];return(e=t.call.apply(t,[this].concat(l))).knob=void 0,e.timer=void 0,e.contextMenu=void 0,e.onMenu=function(t){var n=e.contextMenu,o=n.cell,a=n.edge,l=t.key;if("1"===l){var r,c=a.getSourceNode(),i=a.getTargetNode(),u=null===c||void 0===c?void 0:c.position(),s=null===i||void 0===i?void 0:i.position();console.log("copy edge source and target=======>",c,i);var d=a.clone();d.setSource({x:u.x+50,y:u.y+50}),d.setTarget({x:s.x+50,y:s.y+50}),console.log("origin======>",a),console.log("clone=====>",d),null===(r=e.graph)||void 0===r||r.addEdge(d)}else if("2"===l){var m=e.contextMenu.e;if(o.isNode()){var p,g,v,h=null===(p=e.graph)||void 0===p?void 0:p.getOutgoingEdges(o),f=null===(g=e.graph)||void 0===g?void 0:g.getIncomingEdges(o),b=m.clientX,y=m.clientY,E=e.graph.clientToGraph(b,y);h&&h.forEach(function(e){e.setSource(E)}),f&&f.forEach(function(e){e.setTarget(E)}),null===(v=e.graph)||void 0===v||v.removeCells([o])}else if(o.isEdge()){var _;null===(_=e.graph)||void 0===_||_.removeEdge(o)}}},e.onMouseDown=function(){e.timer=window.setTimeout(function(){e.updatePosition(),e.toggleContextMenu(!1)},200)},e}return Object(a.a)(n,[{key:"render",value:function(){return this.knob||(this.knob=ve.w.createElement("div",!1),this.knob.style.position="absolute",this.container.appendChild(this.knob)),this}},{key:"renderMenu",value:function(){return i.a.createElement(xe.a,{onClick:this.onMenu},i.a.createElement(xe.a.Item,{key:"1"},"\u590d\u5236"),i.a.createElement(xe.a.Item,{key:"2"},"\u5220\u9664"),i.a.createElement(xe.a.Item,{key:"3"},"3"))}},{key:"toggleContextMenu",value:function(e){ge.a.unmountComponentAtNode(this.knob),document.removeEventListener("mousedown",this.onMouseDown),e&&(ge.a.render(i.a.createElement(Ne.a,{visible:!0,trigger:["contextMenu"],overlay:this.renderMenu()},i.a.createElement("span",null,"123")),this.knob),document.addEventListener("mousedown",this.onMouseDown))}},{key:"updatePosition",value:function(e){var t,n=(null===(t=this.knob)||void 0===t?void 0:t.style)||{};if(e){var o=this.graph.clientToGraph(e.clientX,e.clientY);n.left="".concat(o.x,"px"),n.top="".concat(o.y,"px")}else n.left="-1000px",n.top="-1000px"}},{key:"onContextMenu",value:function(e){var t=e.e;this.contextMenu=e,this.timer&&(clearTimeout(this.timer),this.timer=0),this.updatePosition(t),this.toggleContextMenu(!0)}},{key:"delegateEvents",value:function(){return this.cellView.on("cell:contextmenu",this.onContextMenu,this),Object(we.a)(Object(je.a)(n.prototype),"delegateEvents",this).call(this)}},{key:"onRemove",value:function(){this.cellView.off("cell:contextmenu",this.onContextMenu,this)}}]),n}(ve.w.ToolItem);De.config({tagName:"div",isSVGElement:!1});var Le=n(796),Se=n.n(Le),Ae=function(e){Object(l.a)(n,e);var t=Object(r.a)(n);function n(e){var a;return Object(o.a)(this,n),(a=t.call(this,e)).count=void 0,a.onChangeData=function(){var e=a.props.node;console.log("node=======>",e),null===e||void 0===e||e.setData({name:"changeData-".concat(a.count++)})},a.onChangeName=function(){a.setState({name:666})},console.log("constructor"),a.state={name:"default"},a.count=0,a}return Object(a.a)(n,[{key:"shouldComponentUpdate",value:function(e,t){var n=this.props.node,o=this.props.node;return console.log("SCU=====>",n===o),!(null===o||void 0===o||!o.hasChanged("data"))||(console.log("data didnot change"),!1)}},{key:"componentDidMount",value:function(){var e=Date.now(),t=Date.now()-e;console.log("begin===>",e,t)}},{key:"compoenntDidUpdate",value:function(){console.log("didUpdate",this.props)}},{key:"renderClassic",value:function(){var e,t;return i.a.createElement("div",{className:Se.a.root},i.a.createElement("div",{onClick:this.onChangeData},"change data"),i.a.createElement("div",{onClick:this.onChangeName},"change name"),"Triangle-".concat(this.state.name,"-").concat(null===(e=this.props.node)||void 0===e?void 0:null===(t=e.data)||void 0===t?void 0:t.name),"Triangle-")}},{key:"renderSimplified",value:function(){return i.a.createElement("div",null,"simplified")}},{key:"render",value:function(){var e=this.props.node,t=((null===e||void 0===e?void 0:e.getData())||{}).mode;return console.log("mode========>",t),"simplified"===t?this.renderSimplified():this.renderClassic()}}]),n}(c.Component);Ae.componentType=void 0,Ae.title=void 0,Ae.componentType="wfh-triangle",Ae.title="triangle",function(e){Object(l.a)(n,e);var t=Object(r.a)(n);function n(){return Object(o.a)(this,n),t.apply(this,arguments)}return Object(a.a)(n,[{key:"getRegisterName",value:function(){return"wfh-DD"}},{key:"removeNode",value:function(e){return!0}},{key:"canConnect",value:function(e){return!["wfh-rect","wfh-triangle"].includes(e)}}]),n}(ke.a).config({width:200,height:80,component:i.a.createElement("div",null,"wfhdd")});var Ie=function(e){Object(l.a)(n,e);var t=Object(r.a)(n);function n(){var e;Object(o.a)(this,n);for(var a=arguments.length,l=new Array(a),r=0;r<a;r++)l[r]=arguments[r];return(e=t.call.apply(t,[this].concat(l))).mode="classic",e}return Object(a.a)(n,[{key:"setMode",value:function(e){this.mode=e}},{key:"getRegisterName",value:function(){return"wfh-demo"}},{key:"removeNode",value:function(e){return!0}},{key:"canConnect",value:function(e){return!["wfh-rect","wfh-triangle"].includes(e)}}]),n}(ke.a);Ie.config({width:200,height:80,component:i.a.createElement(Ce,null)});var Me=function(e){Object(l.a)(n,e);var t=Object(r.a)(n);function n(){return Object(o.a)(this,n),t.apply(this,arguments)}return Object(a.a)(n,[{key:"getRegisterName",value:function(){return"wfh-rect"}},{key:"removeNode",value:function(e){return!0}},{key:"canConnect",value:function(e){return!["wfh-rect"].includes(e)}}]),n}(ke.a);Me.config({width:160,height:30,portMarkup:[ve.n.getForeignObjectMarkup()],ports:{groups:{in:{position:{name:"top"},attrs:{fo:{width:10,height:10,x:-5,y:-5,magnet:"true"}},zIndex:1},out:{position:{name:"bottom"},attrs:{fo:{width:10,height:10,x:-5,y:-5,magnet:"true"}},zIndex:1}},items:[{group:"in",id:"in1"},{group:"in",id:"in2"},{group:"out",id:"out1"},{group:"out",id:"out2"}]}});var He=function(e){Object(l.a)(n,e);var t=Object(r.a)(n);function n(){return Object(o.a)(this,n),t.apply(this,arguments)}return Object(a.a)(n,[{key:"getRegisterName",value:function(){return"wfh-triangle"}},{key:"removeNode",value:function(e){return!0}},{key:"canConnect",value:function(e){return!["wfh-triangle"].includes(e)}}]),n}(ke.a);He.config({width:160,height:30,component:i.a.createElement(Ae,null),portMarkup:[ve.n.getForeignObjectMarkup()],ports:{groups:{in:{position:{name:"top"},attrs:{fo:{width:10,height:10,x:-5,y:-5,magnet:"true"}},zIndex:1},out:{position:{name:"bottom"},attrs:{fo:{width:10,height:10,x:-5,y:-5,magnet:"true"}},zIndex:1}},items:[{group:"in",id:"in1"},{group:"out",id:"out2"}]}}),ve.m.registerNode("wfh-demo",Ie,!0),ve.m.registerNode("wfh-rect",Me,!0),ve.m.registerNode("wfh-triangle",He,!0),ve.m.registerEdgeTool("contextmenu",De,!0),ve.m.registerNodeTool("contextmenu",De,!0);var Re={nodes:[{id:"node1",x:40,y:40,width:80,height:40,label:"node1"},{id:"node8",x:160,y:180,width:80,height:40,label:"node8"},{id:"node10",x:160,y:180,width:80,height:40,label:"node10",data:{name:"node10",age:123,info:{from:"china"}}}],edges:[{source:{cell:"node1",port:"right"},target:{cell:"node10",port:"top"},data:{age:1,info:{name:"\u8fb9"}}},{source:{cell:"node1",port:"right"},target:{cell:"node8",port:"top"}}]},We=function(e){Object(l.a)(n,e);var t=Object(r.a)(n);function n(){var e;Object(o.a)(this,n);for(var a=arguments.length,l=new Array(a),r=0;r<a;r++)l[r]=arguments[r];return(e=t.call.apply(t,[this].concat(l))).container=null,e.graph=void 0,e.refContainer=function(t){e.container=t},e.onChange=function(){var t=e.props.setCurrent;console.log("setCurrent"),t({name:""})},e.onGetAllData=function(){var t,n,o,a=null===(t=e.graph)||void 0===t?void 0:t.toJSON(),l=null===(n=e.graph)||void 0===n?void 0:n.model,r=null===(o=e.graph)||void 0===o?void 0:o.view;console.log("allData====>",a,l,r)},e.onSwitchMode=function(){var t,n=null===(t=e.graph)||void 0===t?void 0:t.getNodes();null===n||void 0===n||n.forEach(function(e){e.setData({type:"simplified"})})},e.onLayout=function(){var t,n,o,a=(null===(t=e.graph)||void 0===t?void 0:t.getRootNodes())||[],l=(null===(n=e.graph)||void 0===n?void 0:n.getLeafNodes())||[],r=a;console.log("leaf========>",l.length),null===(o=e.graph)||void 0===o||o.batchUpdate(function(){for(var t=0;r.length>0;){console.log("6666666======>",r);var n=r.reduce(function(n,o,a){var l;o.position(0+130*t,0+48*a);var r=null===(l=e.graph)||void 0===l?void 0:l.getNeighbors(o,{outgoing:!0});return n=n.concat(r)},[]);t+=1,r=n}})},e}return Object(a.a)(n,[{key:"componentDidMount",value:function(){var e,t,n,o,a,l,r,i,u,s,d,m,p,g;this.graph=new ve.m({container:this.container,grid:!0,panning:{enabled:!0,modifiers:["alt"]},highlighting:{magnetAvailable:{name:"stroke",args:{padding:3,attrs:{strokeWidth:3,stroke:"#52c41a"}}}},connecting:{snap:!0,allowBlank:!0,allowLoop:!1,allowNode:!0,highlight:!0,validateMagnet:function(e){var t=e.magnet;return console.log("validateMagnet=====>",e),"in"!==t.getAttribute("port-group")},createEdge:function(e){return console.log("createEdge=====>",e),new ve.j({tools:[{name:"contextmenu"}]})},validateConnection:function(e){console.log("validateConnection======>",e);var t=e.targetCell,n=e.sourceCell;return"source"===e.type?console.log("sourceCell======>",n):console.log("targetCell======>",t),!0},validateEdge:function(e){var t=e.edge,n=e.type,o=t.getTarget(),a=t.getSource(),l=t.getSourceNode(),r=t.getTargetNode();if("source"===n){if(!l)return!1}else if("target"===n&&!r)return!1;var c=r.model.getIncomingEdges(r);return console.log("validateEdge====>",c,o,a,e),!0}},interacting:{},onPortRendered:function(e){var t=e.contentSelectors,n=t&&t.foContent;n&&ge.a.render(c.createElement(ye.a,{title:"port"},c.createElement("div",{className:_e.a.myport})),n)}}),this.graph.use(new he.a({enabled:!0})),this.graph.use(new fe.a({enabled:!0,rubberband:!0,strict:!0,movable:!0,showNodeSelectionBox:!0,showEdgeSelectionBox:!0})),this.graph.use(new be.a({enabled:!0})),null===(e=this.graph)||void 0===e||e.on("cell:removed",function(e){console.log("cell:removed====>",e)}),null===(t=this.graph)||void 0===t||t.on("node:removed",function(e){console.log("node:removed====>",e)}),null===(n=this.graph)||void 0===n||n.on("edge:removed",function(e){console.log("edge:removed====>",e)}),null===(o=this.graph)||void 0===o||o.on("cell:selected",function(e){console.log("cell:selected====>",e)}),null===(a=this.graph)||void 0===a||a.on("node:selected",function(e){console.log("node:selected====>",e)}),null===(l=this.graph)||void 0===l||l.on("edge:selected",function(e){var t=e.edge,n=t.target,o=t.source;console.log("edge:selected====>",n,o)}),null===(r=this.graph)||void 0===r||r.on("selection:changed",function(e){console.log("selection:changed======>",e);var t=e.selected,n=t[0];if(null!==n&&void 0!==n&&n.isNode()){var o=n.clone();console.log("cell=====>",n.shape,o.shape,n,o)}if(null!==n&&void 0!==n&&n.isEdge()){var a=n.clone();console.log("cell========>",n.getTargetCellId(),n.getSourceCellId()),console.log("clone========>",a.getTargetCellId(),a.getSourceCellId()),n.on("change:data",function(e){console.log("args======>",e)}),n.setData({configs:{name:123}}),setTimeout(function(){n.setData({configs:{name:"monkey"}})},5e3)}var l=t[0]||{},r=l.target,c=l.source;console.log("==========>",r,c)}),null===(i=this.graph)||void 0===i||i.on("edge:added",function(e){console.log("edge:added===>",e)}),null===(u=this.graph)||void 0===u||u.on("edge:removed",function(e){console.log("edge:removed=====>",e)}),null===(s=this.graph)||void 0===s||s.on("edge:connected",function(e){var t=e.edge,n=t.target,o=t.source;console.log("edge:connected====>",n,o)}),null===(d=this.graph)||void 0===d||d.on("node:mouseenter",function(e){e.cell.addTools([{name:"contextmenu"}])}),null===(m=this.graph)||void 0===m||m.on("node:mouseleave",function(e){e.cell.removeTools()}),null===(p=this.graph)||void 0===p||p.on("edge:mouseenter",function(e){e.cell.addTools([{name:"source-arrowhead"},{name:"target-arrowhead",args:{attrs:{fill:"red"}}},{name:"contextmenu"}])}),null===(g=this.graph)||void 0===g||g.on("edge:mouseleave",function(e){e.cell.removeTools()});var v=this.props.init;setTimeout(function(){var e=[{id:"top",attrs:{circle:{r:6,magnet:!0,stroke:"#31d0c6",strokeWidth:2,fill:"#fff"}}},{id:"right",attrs:{circle:{r:6,magnet:!0,stroke:"#31d0c6",strokeWidth:2,fill:"#fff"}}}],t=Re.nodes.map(function(t){return Object(b.a)(Object(b.a)({},t),{},{ports:e})}),n=Re.edges.map(function(e){return Object(b.a)(Object(b.a)({},e),{},{shape:"edge"})});v({dataList:t,edgeList:n,current:{},configs:{}})},1e3)}},{key:"componentWillUpdate",value:function(){console.log("will-update")}},{key:"componentDidUpdate",value:function(e,t){var n=this.props,o=n.dataList,a=n.edgeList,l=n.dataSource,r=n.current,i=e.dataList,u=e.edgeList;if(!d.a.is(o,i)||!d.a.is(a,u)){console.log("didUpdate");var s=o.toJS();if("DRAG_NODE_DATA"===l){var m,p;console.log("\u62d6\u62fd\u4ea7\u751f\u7684\u6570\u636e=====>",r);var g=null===r||void 0===r?void 0:r.toJS(),v=g.id,h=g.componentType,f={id:v,label:g.title,x:20,y:80,shape:h,component:c.createElement(Ce,null)};null===(m=this.graph)||void 0===m||m.addNode(f),null===(p=this.graph)||void 0===p||p.addEdge({target:{x:10,y:50},source:{x:70,y:50}})}else if("COPY_EDGE_DATA"===l)console.log("\u8fb9\u62f7\u8d1d\u6570\u636e");else{var y,E=s.map(function(e){var t=e.componentType;return t?{id:e.id,height:40,width:80,x:80,y:80,label:t}:Object(b.a)(Object(b.a)({},e),{},{shape:"wfh-demo"})});null===(y=this.graph)||void 0===y||y.fromJSON({nodes:E,edges:null===a||void 0===a?void 0:a.toJS()})}}}},{key:"computer",value:function(e){for(var t=this,n=e||[],o=[],a=0,l=0;n.length>=1;){o[a]=n.length,a++;var r=n.reduce(function(e,n){var o,a=(null===(o=t.graph)||void 0===o?void 0:o.getNeighbors(n,{outgoing:!0}))||[];return l=l>a.length?l:a.length,e=e.concat(a)},[]);n=r}return[o,l]}},{key:"render",value:function(){return console.log("x6------render====>",this.props),c.createElement("div",{className:_e.a.container},c.createElement("div",{className:_e.a.toolbar},c.createElement("button",{onClick:this.onChange},"dispatch"),c.createElement("button",{onClick:this.onGetAllData},"\u83b7\u53d6\u6570\u636e"),c.createElement("button",{onClick:this.onSwitchMode},"\u6539\u53d8\u6a21\u5f0f"),c.createElement("button",{onClick:this.onLayout},"\u81ea\u52a8\u5e03\u5c40")),c.createElement("div",{className:_e.a.graph,ref:this.refContainer}),c.createElement("div",{className:_e.a.config},"\u62bd\u5c49"))}}]),n}(c.PureComponent),Pe=n(797),qe=n.n(Pe),Ge=["CMS_DND_ITEM_TYPE","X6_DND_ITEM_TYPE"],Xe=[{id:Ce.title,name:Ce.title,type:Ge[0],data:{componentType:Ce.componentType,config:{}}},{id:Ae.title,name:Ae.title,type:Ge[0],data:{componentType:Ae.componentType,config:{}}},{id:q.title,name:q.title,type:Ge[0],data:{componentType:q.componentType,config:{}}},{id:H.title,name:H.title,type:Ge[0],data:{componentType:H.componentType,config:{}}},{id:F.title,name:F.title,type:Ge[0],data:{componentType:F.componentType,config:{}}},{id:Z.title,name:Z.title,type:Ge[0],data:{componentType:Z.componentType,config:{}}},{id:ee.title,name:ee.title,type:Ge[0],data:{componentType:ee.componentType,config:{}}},{id:le.title,name:le.title,type:Ge[0],data:{componentType:le.componentType,config:{}}}],Je=function(e){Object(l.a)(n,e);var t=Object(r.a)(n);function n(e){var a;return Object(o.a)(this,n),(a=t.call(this,e)).state={stencilList:d.a.List([])},a}return Object(a.a)(n,[{key:"componentDidMount",value:function(){var e=this;setTimeout(function(){e.setState(function(e){return{stencilList:d.a.List(Xe)}})},1e3)}},{key:"render",value:function(){var e,t=this.props.match,n=(null===(e=(void 0===t?{}:t).params)||void 0===e?void 0:e.type)||"x6",o=this.state.stencilList,a=void 0===o?[]:o;return c.createElement(u.a,{backend:s.a},c.createElement("div",{className:qe.a.dndframe},c.createElement("div",{className:qe.a.sidebar},c.createElement(v,{toolList:a,dragSource:A})),c.createElement("div",{className:qe.a.content},c.createElement(j,{accept:[Ge[0]],workbench:"cms"===n?me:We}))))}}]),n}(c.Component);t.default=Je}}]);
//# sourceMappingURL=8.20636690.chunk.js.map